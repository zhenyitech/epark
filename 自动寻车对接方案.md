# 自动寻车对接方案

## 背景资料

#### MQTT

> MQTT是一个基于客户端-服务器的消息发布/订阅传输协议。MQTT协议是轻量、简单、开放和易于实现的，这些特点使它适用范围非常广泛。在很多情况下，包括受限的环境中，如：机器与机器（M2M）通信和物联网（IoT）。其在，通过卫星链路通信传感器、偶尔拨号的医疗设备、智能家居、及一些小型化设备中已广泛使用。

[参考百科](https://baike.baidu.com/item/MQTT/3618851?fr=ge_ala)


使用标准MQTT库.支持`3.0`与`5.0`版本

#### 测试地址信息

> mqtt测试地址:
>
> ```
> wss://mqtt.zhenyi.tech
> ```
>
> 测试账号:
>
> `
> jiezhong
> `
>
> 密码
>
> `
> jiezhong
> `


## 详细对接


#### 更新车辆状态(mqtt)

主题:`epark/car/index`

payload为json字符串

##### 示例

> 车牌号: MN3770
> 
> 车位编码: 522
> 
> 车辆状态:进入(status:0离开,1占用)
> 
> 时间: 2024-06-16 22:30

###### TOPIC

`epark/car/522`

###### PAYLOAD

`{"plate":"MN3770","status":1,"timestamp":"1718548200"}`


#### 更新车辆点位(rest api)

> 车位编码: `522`
> 
> 当前位置: `p1`
>
> 地图地址: `http://mapurl`


###### API

```
https://apps.zhenyi.tech/epark/map/submit
```

###### BODY


```
{
  "points":[{x1,y1},{x2,y2},{x3,y3},{x4,y4}],
  "index":522,
  "postion":"p1",
  "map":"http://mapurl"
}
```



